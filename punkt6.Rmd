---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

## Et positivt eksogent sjokk i basis-sysselsetting

## Introduksjon

-   hva oppgaven er
-   hva vi skal finne
-   hvordan vi løser det
-   hva det betyr
-   presisere at vi finner basemultiplikator for kommunnene og ikke
    stedene

```{r}
library(data.table)
library(tidyverse)
```

```{r}
Haug_arbeid_punkt2 <- read.csv("Haug_arbeid_punkt2.csv")
```

```{r}
Sunn_arbeid_punkt2 <- read.csv("sunn_arbeid_punkt2.csv")
```

```{r}
Haug_arbeid_punkt4 <- cbind(Haug_arbeid_punkt2, Etne = Sunn_arbeid_punkt2$Etne)
                      
```

```{r}
Haug_arbeid_punkt_ny <- Haug_arbeid_punkt4 %>% 
  mutate(Haugesund1=replace_na(Haugesund, as.numeric(0)),
         Sauda1=replace_na(Sauda, as.numeric(0)),
         Bokn1=replace_na(Bokn, as.numeric(0)),
         Tysvaer1=replace_na(Tysvaer, as.numeric(0)),
         Karmoey1=replace_na(Karmoey, as.numeric(0)),
         Utsira1=replace_na(Utsira, as.numeric(0)),
         Vindafjord1=replace_na(Vindafjord, as.numeric(0)),
         Etne1=replace_na(Etne, as.numeric(0)))
```

```{r, NA.rm=TRUE}
Haug_arbeid_punkt_ny = mutate(Haug_arbeid_punkt_ny, tot_H1 = Haugesund1+Sauda1+Bokn1+Tysvaer1+Karmoey1+Utsira1+Vindafjord1+Etne1)
```

```{r}
punkt6<- Haug_arbeid_punkt_ny%>% 
  select(Naering, Aar, Haugesund1, Vindafjord1, Etne1,tot_H1)
```

```{r}
punkt6 <- filter(punkt6, Aar %in% "2020")
```

## Haugesund kommune, 2020

```{r}
Haugesund_2020 <- select(punkt6, Naering, Aar, Haugesund1, tot_H1)
```

```{r}
Haugesund_2020<- mutate(Haugesund_2020, Lq_Haugesund_2020 = ((Haugesund1/20852)/(tot_H1/50584)))
```

```{r}
Haugesund_2020 <- mutate(Haugesund_2020 , Lokalnaering = case_when(Lq_Haugesund_2020 > 1 ~ "1"),
                          Basisnaering = case_when(Lq_Haugesund_2020 < 1 ~ "1"))
```

-   $E_t$ total sysselsetting: 50584
-   $E_s$ sysselsetting i basisnæringer:

```{r Basisnæringer_Haug_2020}
694+425+2879+751+604+166+1098+1157+1720+5713+713
```

$E_b$ sysselsetting i lokalnæringer:

```{r Lokalnæringer_Haug_2020}
50584-15920
```

## Basemultiplikator Haugesund kommune, 2020

$$E_t = E_b + E_s   \rightarrow  50584 = 34664 + 15920$$

$$E_s = aE_t   \rightarrow 15920=a\cdot50584   \rightarrow   15920/50584=a$$

```{r}
15920/50584
```

$$a=0.314724$$

$$E_t(1-a) = \bar{E}_b \rightarrow 50584(1-0.314724)=\bar{E}_b$$

```{r}
50584*(1-0.314724)
```

$$\bar{E}_b=34664$$

$$\frac{1}{1-a} = basemultiplikatoren   \rightarrow \frac{1}{1-0.314724}=basemultiplikator$$

```{r}
1/(1-0.314724)
```

$$basemultiplikator = 1.459266$$

## Vindafjord kommune, 2020

```{r}
Vindafjord_2020 <- select(punkt6, Naering, Aar, Vindafjord1, tot_H1)
```

```{r}
Vindafjord_2020 <- mutate(Vindafjord_2020, Lq_Vindafjord_2020 = ((Vindafjord1/4898)/(tot_H1/50584)))
```

```{r}
Vindafjord_2020 <- mutate(Vindafjord_2020 , Lokalnaering = case_when(Lq_Vindafjord_2020 > 1 ~ "1"),
                          Basisnaering = case_when(Lq_Vindafjord_2020 < 1 ~ "1"))
```

-   $E_t$ total sysselsetting: 50584
-   $E_s$ sysselsetting i basisnæringer:

```{r Basisnæringer_Vind_2020}
578+887+101+638+149+216+31
```

$E_b$ sysselsetting i lokalnæringer:

```{r Lokalnæringer_Vind_2020}
50584-2600
```

## Basemultiplikator Vindafjord kommune, 2020

$$E_t = E_b + E_s   \rightarrow  50584 = 47984 + 2600$$

$$E_s = aE_t   \rightarrow 2600=a\cdot50584   \rightarrow   2600/50584=a$$

```{r}
2600/50584
```

$$a=0.05139965$$

$$E_t(1-a) = \bar{E}_b \rightarrow 50584(1-0.05139965)=\bar{E}_b$$

```{r}
50584*(1-0.05139965)
```

$$\bar{E}_b=47984$$

$$\frac{1}{1-a} = basemultiplikatoren \rightarrow \frac{1}{1-0.05139965}=basemultiplikator$$

```{r}
1/(1-0.05139965)
```

$$basemultiplikator = 1.054185$$

## Etne kommune, 2020

```{r}
Etne_2020 <- select(punkt6, Naering, Aar, Etne1, tot_H1)
```

```{r}
Etne_2020<- mutate(Etne_2020, Lq_Etne_2020 = ((Etne1/1613)/(tot_H1/50584)))
```

```{r}
Etne_2020 <- mutate(Etne_2020 , Lokalnaering = case_when(Lq_Etne_2020 > 1 ~ "1"),
                          Basisnaering = case_when(Lq_Etne_2020 < 1 ~ "1"))
```

-   $E_t$ total sysselsetting: 50584
-   $E_s$ sysselsetting i basisnæringer:

```{r Basisnæringer_Etne_2020}
172+242+51+68
```

$E_b$ sysselsetting i lokalnæringer:

```{r Lokalnæringer_Etne_2020}
50584-533
```

## Basemultiplikator Etne kommune 2020

$$E_t = E_b + E_s   \rightarrow  50584 = 50051 + 533$$

$$E_s = aE_t   \rightarrow 533=a\cdot50584   \rightarrow   533/50584=a$$

```{r}
533/50584
```

$$a=0.01053693$$

$$E_t(1-a) = \bar{E}_b \rightarrow 21322(1-0.01053693)=\bar{E}_b$$

```{r}
50584*(1-0.01053693)
```

$$\bar{E}_b=50051$$

$$\frac{1}{1-a} = basemultiplikatoren   \rightarrow \frac{1}{1-0.01053693}=basemultiplikator$$

```{r}
1/(1-0.01053693)
```

$$basemultiplikator = 1.010649$$

## Et positivt eksogent sjokk i basis-sysselsetting; Haugesund, Ølensvåg og Skånevik

Haugesund:

$$basemultiplikator \cdot 500 = 1.459266\cdot 500$$

```{r}
1.459266*500
```

Ølensvåg:

$$basemultiplikator\cdot 500 = 1.054185\cdot 500$$

```{r}
1.054185*500
```

$$basemultiplikator\cdot 500 = 1.010649\cdot 500$$

```{r}
1.010649*500
```

## Forklare

Etter å ha multiplisert basemultiplikatoren med 500 nye arbeidstakere,
er resultanene som følger:

**Haugesund:** 729.633 
**Ølensvåg:** 527.0925 
**Skånevik:** 505.3245

Vi har videre tolket resultatene hvor vi har tatt totalen og trukket fra
500 for å finne hvor stor andel som tilhører basisnæringen og hvor stor
andel som tilhører lokanæringen.

-   **Haugesund:** 729.633 
    729.633 - 500 = 229.633
    500 tilhører basisnæringen og resterende 229.633 ≈ 230 tilhører lokalnæringen.
    
-   **Ølensvåg:** 527.0925
    527.0925 - 500 = 27.0925
    500 tilhører basisnæringen og resterende 27.0925 ≈ 27 tilhører lokalnæringen. 
    
-   **Skånevik:** 505.3245
    505.3245 - 500 = 5.3245
    500 tilhører basisnæringen og resterende 5.3245 ≈ 5 tilhører lokalnæringen.


## Sammenligne med pendlerinnstrømmingen

## Konklusjon
